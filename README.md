# Gemini TTS API (Text-to-Speech)

Это приложение представляет собой FastAPI сервис, обернутый в Docker-контейнер, который предоставляет API для преобразования текста в речь (TTS) с использованием Google Gemini API.

## Особенности

* Преобразование текста в речь через Google Gemini.
* Возможность выбора голоса (например, "Zephyr").
* Возвращает аудиофайл в формате MP3/WAV (или в исходном формате, если он уже WAV).
* Легко развертывается с помощью Docker.

## Предварительные требования

1.  **Docker**: Убедитесь, что Docker установлен и запущен на вашем компьютере. ([Инструкция по установке Docker](https://docs.docker.com/get-docker/))
2.  **Google Gemini API Key**: Вам необходим действительный API ключ от Google для доступа к Gemini API. Вы можете получить его из [Google AI Studio](https://aistudio.google.com/app/apikey) или Google Cloud Console.

## Структура проекта

* .
* ├── Dockerfile        # Инструкции для сборки Docker-образа
* ├── main.py           # Основной код FastAPI приложения
* ├── README.md         # Этот файл
* └── requirements.txt  # Список Python-зависимостей

## Настройка и Установка

1.  **Клонируйте репозиторий** (если применимо) или убедитесь, что у вас есть все файлы проекта (`main.py`, `Dockerfile`, `requirements.txt`).

2.  **API Ключ Gemini**:
    Приложение требует, чтобы `GEMINI_API_KEY` был установлен как переменная окружения. **Без этого ключа приложение не запустится.**

## Сборка Docker-образа

Перейдите в корневую директорию проекта в вашем терминале и выполните следующую команду для сборки Docker-образа:

```bash
docker build -t gemini-tts-api .

```
* -t gemini-tts-api: Задает имя (тег) для вашего образа. Вы можете выбрать другое имя.
* .: Указывает, что Dockerfile и контекст сборки находятся в текущей директории.
### Запуск Docker-контейнера
## После успешной сборки образа запустите Docker-контейнер:

docker run -d -p 8000:8000 -e GEMINI_API_KEY="ВАШ_ДЕЙСТВИТЕЛЬНЫЙ_API_КЛЮЧ" --name my-tts-container gemini-tts-api

## Использование API

После запуска контейнера API будет доступно на порту, который вы указали (например, `8000`).

### Эндпоинт

- **URL:** `/generate-tts/`  
- **Метод:** `POST`

### Тело запроса

Запрос должен быть в формате **JSON** и содержать следующие поля:

- `text` (`string`, **обязательное**) — Текст, который нужно преобразовать в речь.
- `voice_name` (`string`, необязательное) — Имя голоса для озвучивания.  
  По умолчанию используется `"Zephyr"`. Список доступных голосов можно найти в документации **Google Gemini**.
```json
{
  "text": "Привет, это голосовой ассистент Gemini!",
  "voice_name": "Zephyr"
}
```

### Пример запроса с использованием `curl`

Замените `8001` на порт вашего хоста, если вы использовали другой.

#### Bash

```bash
curl -X POST "http://localhost:8000/generate-tts/" \
     -H "Content-Type: application/json" \
     -d '{"text": "Это тестовое сообщение для Gemini TTS.", "voice_name": "Zephyr"}' \
     --output speech_output.wav
```

## Описание

Эта команда отправит запрос и сохранит полученный аудиофайл как `speech_output.wav` в текущей директории.

---

## Успешный ответ

- **Статус код:** `200 OK`
- **Тело ответа:** Бинарные данные аудиофайла.
- **Заголовки:**
  - `Content-Type`: например, `audio/wav`
  - `Content-Disposition`: например, `attachment; filename="speech.wav"`

---

## Ошибки

- **400 Bad Request**  
  Возникает, если поле `text` пустое или запрос некорректен.

- **422 Unprocessable Entity**  
  Если тело запроса не соответствует Pydantic-модели (например, неправильные типы данных).

- **500 Internal Server Error**  
  Ошибки на стороне сервера, включая:
  - Проблемы с Gemini API (неверный ключ, сбой сервиса и т.д.)
  - Ошибки конвертации аудио.  
  Проверьте логи контейнера для диагностики.

---

## Важно

Если переменная `GEMINI_API_KEY` не установлена при запуске, контейнер не запустится корректно. Вы увидите ошибку в логах Docker или при попытке запуска.
